<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TUF Goes to Serbia - LAUNCHub Ventures</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #f8f9fa;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 24px;
            background: #ffffff;
            border-bottom: 1px solid #eee;
        }
        .logo-container { display: flex; align-items: center; gap: 12px; }
        .logo-text { font-size: 24px; font-weight: 700; color: #1a1a2e; letter-spacing: -0.5px; }
        .logo-text span { color: #8B6B9B; }
        .subtitle { font-size: 14px; color: #666; font-weight: 400; }
        .back-link {
            color: #8B6B9B;
            text-decoration: none;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .back-link:hover { text-decoration: underline; }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #8B6B9B 0%, #6B4B7B 100%);
            padding: 40px 24px;
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 400px;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='%23ffffff' fill-opacity='0.08' d='M50 10 L90 90 L10 90 Z'/%3E%3C/svg%3E") no-repeat center;
            background-size: contain;
            opacity: 0.3;
        }
        .hero-content {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        .hero-title {
            font-size: clamp(28px, 4vw, 36px);
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 8px;
        }
        .hero-subtitle {
            font-size: 16px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 24px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            max-width: 900px;
        }
        .stat-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-left: 4px solid #8B6B9B;
        }
        .stat-value {
            font-size: clamp(32px, 4vw, 42px);
            font-weight: 700;
            color: #1a1a2e;
            margin-bottom: 4px;
            line-height: 1;
        }
        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }

        /* Tab Navigation */
        .tab-container {
            background: #ffffff;
            border-bottom: 1px solid #eee;
            padding: 0 24px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .tabs {
            display: flex;
            gap: 4px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .tab {
            padding: 16px 24px;
            border: none;
            background: transparent;
            font-family: inherit;
            font-size: 14px;
            font-weight: 500;
            color: #666;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            border-radius: 8px 8px 0 0;
            margin-bottom: -1px;
        }
        .tab:hover {
            color: #8B6B9B;
            background: #f8f5fa;
        }
        .tab.active {
            color: #8B6B9B;
            background: #f8f5fa;
            font-weight: 600;
        }
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: #8B6B9B;
        }
        .tab-badge {
            background: #E8D5E8;
            color: #6B4B7B;
            font-size: 11px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 10px;
        }
        .tab.active .tab-badge {
            background: #8B6B9B;
            color: #ffffff;
        }
        /* Tab accent colors */
        .tab[data-tab="founders"].active { color: #C97B84; }
        .tab[data-tab="founders"].active::after { background: #C97B84; }
        .tab[data-tab="founders"].active .tab-badge { background: #C97B84; }
        .tab[data-tab="katapult"].active { color: #6B9B8B; }
        .tab[data-tab="katapult"].active::after { background: #6B9B8B; }
        .tab[data-tab="katapult"].active .tab-badge { background: #6B9B8B; }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 24px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* Source Info Banner */
        .source-banner {
            display: none;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: #f0f0f0;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 13px;
            color: #666;
        }
        .source-banner.visible { display: flex; }
        .source-banner.companies { background: #F5F0F7; color: #6B4B7B; }
        .source-banner.founders { background: #FDF2F3; color: #9B5B64; }
        .source-banner.katapult { background: #F2F7F5; color: #4B7B6B; }
        .source-banner svg {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        /* Grid Container */
        .grid-container {
            height: calc(100vh - 380px);
            min-height: 400px;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        /* AG Grid Customization */
        .ag-theme-alpine {
            --ag-header-background-color: #fafafa;
            --ag-header-foreground-color: #1a1a2e;
            --ag-row-hover-color: #f5f0f7;
            --ag-selected-row-background-color: #E8D5E8;
            --ag-font-family: 'Inter', sans-serif;
            --ag-font-size: 13px;
            --ag-border-color: #eee;
        }
        .ag-theme-alpine .ag-header-cell-label {
            font-weight: 600;
        }
        .ag-theme-alpine .ag-cell {
            display: flex;
            align-items: center;
        }

        /* Score Cell Styling */
        .score-cell {
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        .score-high { background: #dcfce7; color: #166534; }
        .score-medium { background: #fef3c7; color: #92400e; }
        .score-low { background: #fee2e2; color: #991b1b; }
        .score-na { color: #999; }

        /* Link Cell Styling */
        .link-cell a {
            color: #8B6B9B;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .link-cell a:hover { text-decoration: underline; }

        /* Tab Panels */
        .tab-panel { display: none; }
        .tab-panel.active { display: block; }

        /* Cell detail modal (double-click to expand) */
        .cell-modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.4);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .cell-modal-overlay.visible { display: flex; }
        .cell-modal {
            background: #fff;
            border-radius: 12px;
            padding: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }
        .cell-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid #eee;
        }
        .cell-modal-title {
            font-size: 14px;
            font-weight: 600;
            color: #1a1a2e;
        }
        .cell-modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #666;
            padding: 4px 8px;
            border-radius: 4px;
        }
        .cell-modal-close:hover { background: #f0f0f0; }
        .cell-modal-body {
            font-size: 14px;
            line-height: 1.6;
            color: #333;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Responsive - Tablet */
        @media (max-width: 1024px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
            .stat-card { padding: 16px; }
            .stat-value { font-size: 28px; }
        }

        /* Responsive - Mobile */
        @media (max-width: 768px) {
            .header { flex-wrap: wrap; gap: 8px; padding: 12px 16px; }
            .back-link { font-size: 12px; }
            .hero { padding: 20px 16px; }
            .hero-title { font-size: 24px; }
            .hero-subtitle { font-size: 14px; margin-bottom: 16px; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; max-width: 100%; }
            .stat-card { padding: 14px; border-radius: 12px; }
            .stat-value { font-size: 24px; }
            .stat-label { font-size: 10px; }
            .tab-container { padding: 0 12px; }
            .tabs { overflow-x: auto; -webkit-overflow-scrolling: touch; }
            .tab { padding: 12px 14px; font-size: 13px; white-space: nowrap; }
            .tab-badge { font-size: 10px; padding: 2px 6px; }
            .main-content { padding: 12px; }
            .source-banner { font-size: 12px; padding: 10px 12px; }
            .grid-container { height: calc(100vh - 380px); min-height: 350px; }
        }

        @media (max-width: 640px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .logo-text { font-size: 20px; }
            .subtitle { font-size: 12px; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo-container">
            <div>
                <div class="logo-text">LAUNC<span>Hub</span></div>
                <div class="subtitle">TUF Goes to Serbia</div>
            </div>
        </div>
        <a href="https://todorv-vibing.github.io/tuf_website_ux/" class="back-link">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Back to CEE Map
        </a>
    </header>

    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">Serbian Startup Ecosystem</h1>
            <p class="hero-subtitle">Product-focused venture pipeline analysis for Serbia</p>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="stat-companies">-</div>
                    <div class="stat-label">Product Companies</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-founders">-</div>
                    <div class="stat-label">Total Founders</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-avg-score">-</div>
                    <div class="stat-label">Avg Overall Score</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-high-score">-</div>
                    <div class="stat-label">Score 7+ Companies</div>
                </div>
            </div>
        </div>
    </section>

    <nav class="tab-container">
        <div class="tabs">
            <button class="tab active" data-tab="companies">
                Serbian Product Companies
                <span class="tab-badge" id="badge-companies">0</span>
            </button>
            <button class="tab" data-tab="founders">
                Founders
                <span class="tab-badge" id="badge-founders">0</span>
            </button>
            <button class="tab" data-tab="katapult">
                Katapult Accelerator
                <span class="tab-badge" id="badge-katapult">0</span>
            </button>
        </div>
    </nav>

    <main class="main-content">
        <!-- Serbian Product Companies Panel -->
        <div class="tab-panel active" id="panel-companies">
            <div class="source-banner companies visible">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4M12 8h.01"/>
                </svg>
                <span>Product companies from LinkedIn founder scrape with full scoring (Founder + Product + Market)</span>
            </div>
            <div class="grid-container">
                <div id="grid-companies" class="ag-theme-alpine" style="width: 100%; height: 100%;"></div>
            </div>
        </div>

        <!-- Founders Panel -->
        <div class="tab-panel" id="panel-founders">
            <div class="source-banner founders visible">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4M12 8h.01"/>
                </svg>
                <span>Founder-centric data with education and scoring. Double-click any cell to view full text.</span>
            </div>
            <div class="grid-container">
                <div id="grid-founders" class="ag-theme-alpine" style="width: 100%; height: 100%;"></div>
            </div>
        </div>

        <!-- Katapult Panel -->
        <div class="tab-panel" id="panel-katapult">
            <div class="source-banner katapult visible">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4M12 8h.01"/>
                </svg>
                <span>Portfolio companies from Katapult Accelerator program</span>
            </div>
            <div class="grid-container">
                <div id="grid-katapult" class="ag-theme-alpine" style="width: 100%; height: 100%;"></div>
            </div>
        </div>
    </main>

    <!-- Cell Detail Modal -->
    <div class="cell-modal-overlay" id="cellModal">
        <div class="cell-modal">
            <div class="cell-modal-header">
                <span class="cell-modal-title" id="cellModalTitle">Cell Detail</span>
                <button class="cell-modal-close" id="cellModalClose">&times;</button>
            </div>
            <div class="cell-modal-body" id="cellModalBody"></div>
        </div>
    </div>

    <script>
        // Cell Renderers
        function scoreCellRenderer(params) {
            if (params.value === null || params.value === undefined || params.value === '') {
                return '<span class="score-cell score-na">&mdash;</span>';
            }
            const score = parseFloat(params.value);
            let className = 'score-low';
            if (score >= 7) className = 'score-high';
            else if (score >= 5) className = 'score-medium';
            return `<span class="score-cell ${className}">${score.toFixed(1)}</span>`;
        }

        function linkCellRenderer(params) {
            if (!params.value) return '<span class="score-na">&mdash;</span>';
            const url = params.value;
            const displayText = url.includes('linkedin.com') ? 'LinkedIn' : 'Website';
            return `<span class="link-cell"><a href="${url}" target="_blank" rel="noopener">${displayText} &nearr;</a></span>`;
        }

        // Grid Instances
        let companiesGrid, foundersGrid, katapultGrid;

        // Check if mobile
        const isMobile = window.innerWidth <= 768;

        // Companies Grid Columns (Tab 1)
        const companiesColumns = [
            { headerName: '#', valueGetter: params => params.node.rowIndex + 1, width: 50, pinned: 'left' },
            { headerName: 'Company', field: 'company_name', flex: 1.5, filter: true, sortable: true, minWidth: 120 },
            { headerName: 'Website', field: 'company_website', cellRenderer: linkCellRenderer, width: 90, hide: isMobile },
            { headerName: 'Founder', field: 'founder_name', flex: 1, filter: true, sortable: true, minWidth: 100, hide: isMobile },
            { headerName: 'LinkedIn', field: 'person_linkedin_url', cellRenderer: linkCellRenderer, width: 90, hide: isMobile },
            { headerName: 'Overall', field: 'overall_weighted_score', cellRenderer: scoreCellRenderer, width: 80, sortable: true, sort: 'desc' },
            { headerName: 'Founder', field: 'founder_score', cellRenderer: scoreCellRenderer, width: 80, sortable: true, hide: isMobile },
            { headerName: 'Product', field: 'product_score', cellRenderer: scoreCellRenderer, width: 80, sortable: true, hide: isMobile },
            { headerName: 'Market', field: 'market_opportunity_score', cellRenderer: scoreCellRenderer, width: 80, sortable: true, hide: isMobile }
        ];

        // Founders Grid Columns (Tab 2)
        const foundersColumns = [
            { headerName: '#', valueGetter: params => params.node.rowIndex + 1, width: 50, pinned: 'left' },
            { headerName: 'Founder Name', field: 'full_name', flex: 1.2, filter: true, sortable: true, minWidth: 120 },
            { headerName: 'LinkedIn', field: 'linkedin_url', cellRenderer: linkCellRenderer, width: 90 },
            { headerName: 'Education', field: 'education', flex: 2, filter: true, minWidth: 200,
              cellStyle: { 'white-space': 'nowrap', 'overflow': 'hidden', 'text-overflow': 'ellipsis' }
            },
            { headerName: 'Score', field: 'founder_score', cellRenderer: scoreCellRenderer, width: 80, sortable: true, sort: 'desc' }
        ];

        // Katapult Grid Columns (Tab 3 - same as Tab 1)
        const katapultColumns = [
            { headerName: '#', valueGetter: params => params.node.rowIndex + 1, width: 50, pinned: 'left' },
            { headerName: 'Company', field: 'company_name', flex: 1.5, filter: true, sortable: true, minWidth: 120 },
            { headerName: 'Website', field: 'company_website', cellRenderer: linkCellRenderer, width: 90, hide: isMobile },
            { headerName: 'Founder', field: 'founder_name', flex: 1, filter: true, sortable: true, minWidth: 100, hide: isMobile },
            { headerName: 'LinkedIn', field: 'person_linkedin_url', cellRenderer: linkCellRenderer, width: 90, hide: isMobile },
            { headerName: 'Overall', field: 'overall_weighted_score', cellRenderer: scoreCellRenderer, width: 80, sortable: true, sort: 'desc' },
            { headerName: 'Founder', field: 'founder_score', cellRenderer: scoreCellRenderer, width: 80, sortable: true, hide: isMobile },
            { headerName: 'Product', field: 'product_score', cellRenderer: scoreCellRenderer, width: 80, sortable: true, hide: isMobile },
            { headerName: 'Market', field: 'market_opportunity_score', cellRenderer: scoreCellRenderer, width: 80, sortable: true, hide: isMobile }
        ];

        // Cell detail modal
        const modal = document.getElementById('cellModal');
        const modalTitle = document.getElementById('cellModalTitle');
        const modalBody = document.getElementById('cellModalBody');
        const modalClose = document.getElementById('cellModalClose');

        function showCellDetail(colName, value) {
            modalTitle.textContent = colName;
            modalBody.textContent = value || '(empty)';
            modal.classList.add('visible');
        }

        modalClose.addEventListener('click', () => modal.classList.remove('visible'));
        modal.addEventListener('click', (e) => {
            if (e.target === modal) modal.classList.remove('visible');
        });
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') modal.classList.remove('visible');
        });

        // Initialize Grids
        document.addEventListener('DOMContentLoaded', () => {
            companiesGrid = agGrid.createGrid(document.getElementById('grid-companies'), {
                columnDefs: companiesColumns,
                rowData: [],
                defaultColDef: { resizable: true },
                animateRows: true,
                pagination: true,
                paginationPageSize: 50
            });

            foundersGrid = agGrid.createGrid(document.getElementById('grid-founders'), {
                columnDefs: foundersColumns,
                rowData: [],
                defaultColDef: { resizable: true },
                animateRows: true,
                pagination: true,
                paginationPageSize: 50,
                onCellDoubleClicked: (params) => {
                    const colName = params.colDef.headerName;
                    const value = params.value;
                    if (value && typeof value === 'string' && value.length > 30) {
                        showCellDetail(colName + ' - ' + params.data.full_name, value);
                    }
                }
            });

            katapultGrid = agGrid.createGrid(document.getElementById('grid-katapult'), {
                columnDefs: katapultColumns,
                rowData: [],
                defaultColDef: { resizable: true },
                animateRows: true,
                pagination: true,
                paginationPageSize: 50
            });

            loadAllData();
        });

        // Fetch data from local JSON files
        async function fetchJsonFile(filename) {
            try {
                const response = await fetch(filename);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                return await response.json();
            } catch (error) {
                console.error(`Error fetching ${filename}:`, error);
                return [];
            }
        }

        async function loadAllData() {
            const companiesData = await fetchJsonFile('serbian_companies.json');
            companiesGrid.setGridOption('rowData', companiesData);
            document.getElementById('badge-companies').textContent = companiesData.length;
            updateStats(companiesData);

            const foundersData = await fetchJsonFile('serbian_founders.json');
            foundersGrid.setGridOption('rowData', foundersData);
            document.getElementById('badge-founders').textContent = foundersData.length;

            const katapultData = await fetchJsonFile('katapult.json');
            katapultGrid.setGridOption('rowData', katapultData);
            document.getElementById('badge-katapult').textContent = katapultData.length;
        }

        function updateStats(data) {
            const companies = data.length;
            const founders = data.length;
            const scored = data.filter(d => d.overall_weighted_score);
            const avgScore = scored.reduce((sum, d) => sum + d.overall_weighted_score, 0) / (scored.length || 1);
            const highScore = scored.filter(d => d.overall_weighted_score >= 7).length;

            document.getElementById('stat-companies').textContent = companies;
            document.getElementById('stat-founders').textContent = founders;
            document.getElementById('stat-avg-score').textContent = avgScore.toFixed(1);
            document.getElementById('stat-high-score').textContent = highScore;
        }

        // Tab Switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.dataset.tab;
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
                document.getElementById(`panel-${tabId}`).classList.add('active');
                setTimeout(() => {
                    if (tabId === 'companies') companiesGrid.sizeColumnsToFit?.();
                    else if (tabId === 'founders') foundersGrid.sizeColumnsToFit?.();
                    else if (tabId === 'katapult') katapultGrid.sizeColumnsToFit?.();
                }, 100);
            });
        });
    </script>
</body>
</html>
